# Структура JavaScript модулей

## Что было сделано

Большой файл `app.js` (654 строки) был разбит на 5 логических модулей для упрощения работы с кодом.

## Структура папки js/

```
js/
├── data.js          # Данные (отделения, здания, синонимы)
├── utils.js         # Вспомогательные функции (поиск, иконки)
├── map-controls.js  # Управление картой (зум, подсветка)
├── ui.js            # Интерфейс (списки, детали зданий)
└── app.js           # Инициализация приложения
```

## Описание модулей

### 1. `data.js` (134 строки)
**Что содержит:**
- Список всех отделений больницы (`pracoviste`)
- Информация о зданиях (`budovyData`)
- Словарь синонимов для поиска (`synonyma`)

**Когда менять:**
- Добавление/изменение отделений
- Обновление данных о зданиях
- Добавление новых синонимов для поиска

---

### 2. `utils.js` (53 строки)
**Что содержит:**
- `getPoiIcon()` — SVG иконки для точек интереса (аптека, банкомат, и т.д.)
- `normalize()` — удаление диакритики из текста
- `search()` — поиск отделений с учётом синонимов

**Когда менять:**
- Добавление новых типов POI и их иконок
- Изменение логики поиска
- Добавление новых синонимов

---

### 3. `map-controls.js` (138 строк)
**Что содержит:**
- `highlightBudova()` — подсветка здания на карте
- `clearHighlight()` — снятие подсветки
- `smoothResizeMap()` — плавное изменение размера карты
- `zoomToBuilding()` — приближение к выбранному зданию
- `panZoomInstance` — глобальная переменная для управления картой

**Когда менять:**
- Изменение анимаций карты
- Настройка скорости зума
- Изменение логики центрирования

---

### 4. `ui.js` (177 строк)
**Что содержит:**
- `renderWorkplaceList()` — отрисовка списка отделений с алфавитным разделением
- `showBuildingDetail()` — показ детальной информации о здании
- `closeBuildingDetail()` — закрытие детальной информации

**Когда менять:**
- Изменение внешнего вида списков
- Добавление новых вкладок в детали здания
- Изменение структуры отображения информации

---

### 5. `app.js` (58 строк)
**Что содержит:**
- Инициализация приложения при загрузке страницы
- Обработчики событий (клики, поиск)
- Инициализация svg-pan-zoom
- Навешивание событий на кнопки

**Когда менять:**
- Добавление новых кнопок или элементов управления
- Изменение логики инициализации

---

## Порядок подключения модулей

В файле `index.html` модули подключаются в строгом порядке:

```html
<script src="js/data.js"></script>         <!-- 1. Данные -->
<script src="js/utils.js"></script>        <!-- 2. Утилиты -->
<script src="js/map-controls.js"></script> <!-- 3. Управление картой -->
<script src="js/ui.js"></script>           <!-- 4. UI функции -->
<script src="js/app.js"></script>          <!-- 5. Инициализация -->
```

**⚠️ Важно:** Порядок подключения нельзя менять, так как каждый последующий модуль использует функции и переменные из предыдущих.

---

## Преимущества новой структуры

✅ **Легче найти нужный код** — каждый модуль отвечает за свою область  
✅ **Проще поддерживать** — изменения в одном модуле не затрагивают другие  
✅ **Меньше контекста для LLM** — можно загружать только нужные модули  
✅ **Понятная структура** — сразу видно, где что находится  

---

## Как работать с модулями

### Добавить новое отделение
→ Редактируй `js/data.js`, массив `pracoviste`

### Добавить новую иконку POI
→ Редактируй `js/utils.js`, функцию `getPoiIcon()`

### Изменить скорость анимации зума
→ Редактируй `js/map-controls.js`, функцию `zoomToBuilding()`, параметр `duration`

### Изменить внешний вид списка отделений
→ Редактируй `js/ui.js`, функцию `renderWorkplaceList()`

### Добавить новую кнопку
→ Редактируй `js/app.js`, секцию с event listeners

---

## Технические детали

- Все модули используют **глобальные переменные** (не ES6 модули)
- Работает как в браузере напрямую, так и через HTTP-сервер
- Никаких изменений в функционале — только реорганизация кода
- Все прежние функции работают точно так же

---

**Дата рефакторинга:** 7 октября 2025
